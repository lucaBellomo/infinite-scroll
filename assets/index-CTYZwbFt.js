(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(e){if(e.ep)return;e.ep=!0;const o=r(e);fetch(e.href,o)}})();const u=Array(1e3).fill(void 0).map((n,t)=>({name:`user${t}`,id:`id_${t}`})),v=u.length,g=()=>new Promise(n=>setTimeout(n,500)),y=async({page:n=0,limit:t=100})=>{const r=n*t,i=(n+1)*t;return await g(),{data:u.slice(r,i),done:i>=v}};async function*L({page:n=0,limit:t=10}={}){for(;;){const r=await y({page:n++,limit:t});if(yield r,r.done)return}}function E({containerSelector:n,itemGenerator:t,renderItem:r,loadMoreThreshold:i=50}){const e=document.querySelector(n);if(!e)throw new Error(`Container not found: ${n}`);let o=!1;const s=async()=>{if(o)return;o=!0;const d=new CustomEvent("infinite-scroll-loading",{detail:{loading:!0}});e.dispatchEvent(d);const{value:c,done:f}=await t.next(),m=new CustomEvent("infinite-scroll-loading",{detail:{loading:!1}});if(e.dispatchEvent(m),o=!1,f){e.removeEventListener("scroll",l);return}c&&c.data.forEach(p=>{const h=r(p);e.appendChild(h)})},l=()=>{const d=e.scrollHeight,c=e.scrollTop+e.clientHeight;d-c<i&&s()};return s(),e.addEventListener("scroll",l),()=>{e.removeEventListener("scroll",l)}}const w=n=>{var t;if(n){const r=document.createElement("div");r.classList.add("loader"),r.classList.add("--1");const i=document.createElement("div");i.classList.add("loader--wrapper"),i.appendChild(r),document.body.appendChild(i)}else(t=document.querySelector(".loader--wrapper"))==null||t.remove()};document.querySelector("#app").innerHTML=`
  <div>
    <h1>Infinite scroll</h1>
    <div id="infinite-scroll-container"></div>
  </div>
`;function C(n){const t=document.createElement("div");return t.classList.add("user-item"),t.textContent=`User ${n.name}`,t}const O=E({containerSelector:"#infinite-scroll-container",itemGenerator:L(),renderItem:C,loadMoreThreshold:50});var a;(a=document.querySelector("#infinite-scroll-container"))==null||a.addEventListener("infinite-scroll-loading",n=>{var t;console.log(n.detail),w((t=n.detail)==null?void 0:t.loading)});window.addEventListener("beforeunload",()=>{O()});
